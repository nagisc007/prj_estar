# -*- coding: utf-8 -*-
"""Story: chapter 02: The another me
"""
import os
import sys
sys.path.append(os.path.join(os.path.dirname(__file__), '../..'))
sys.path.append('storybuilder')

from storybuilder.builder import world as wd
from src.anotherme import config as cnf
THM = cnf.THEMES


# scenes
def sc_visited(w: wd.World):
    kyoko, shota, child, stu = w.kyoko, w.shota, w.child_kyoko, w.student_kyoko
    return w.scene("訪問者",
            kyoko.look().d("$meに微笑み掛けながらその指に赤い毛糸で三本線の川を作って見せている彼は",
                "何も返事がないことに僅かに眉を顰めると",
                "再度言った"),
            shota.talk().t("$kyokoさん？", "おかえりだよ"),
            child.talk().t("おかえりだよ。", "キャハハ"),
            kyoko.look().d("その青年の右肩に両手を載せて笑い声を上げながら飛び上がるのは",
                "十歳の頃の$meだ。",
                "けれど本当ならそれは",
                "$me以外に見えるはずのない$i_IF",
                "$i_imagefriendだった"),
            kyoko.talk().t("ねえ……あなたって",
                "何者？"),
            kyoko.look().d("外灯の明かりでスチール製の階段に座っている彼の姿がぼんやりと見えているけれど",
                "その白い肌の所為か", "薄っすら浮かんでいるようにすら感じる。",
                "サラサラの細い髪がアイドルグループの誰かみたいに眉の上で切り揃えられていて",
                "二重のころころとした瞳が小動物を思わせた"),
            shota.talk().t("$n_shotaという名前に心当たりはある？"),
            kyoko.think().d("当然聞いたことはないし",
                "仮にその名を知っていたとして",
                "彼と何の関係があるというのだろう。",
                "$meは小さく首を振る"),
            shota.talk().t("それは残念。",
                "$meの名前が$n_shotaなんだ"),
            kyoko.talk().t("からかってるんですか？"),
            shota.talk().t("そっちこそ", "大事な約束", "忘れたのかな？"),
            kyoko.think().d("約束", "というワードに一瞬軽い目眩がした"),
            kyoko.look().d("彼", "$n_shotaは立ち上がると$childに毛糸を渡し",
                "階段を降りる。",
                "$meの前に立つと目線が十センチほど高い。",
                "切れ長のとても澄んだ瞳がぼんやり照らされ", "じっと向けられた"),
            kyoko.ask().t("どうして$childが見えるんですか？"),
            kyoko.look().d("けれど彼は首を傾げ", "意味の分からない苦笑を浮かべる"),
            kyoko.talk().t("あの子は$meの$i_IF……つまり$i_imagefriendなんですよ？"),
            shota.talk().t("それって小さい頃に空想上の遊び相手が見えるってやつでしょ？",
                "でもさ"),
            kyoko.look().d("彼は振り返り",
                "一人で階段に腰掛けて綾取りをして遊ぶ$childを確かに見ていた"),
            shota.talk().t("ちゃんと$meの目からは赤い糸で綾取りをしている女の子が見えているよ"),
            kyoko.look().d("嘘や冗談の類で$meをからかっている訳ではなさそうだ"),
            kyoko.think().d("幽霊？"),
            kyoko.think().d("そんな可能性を思いついて恐くなり",
                "$meは慌てて彼を迂回すると、"),
            kyoko.talk().t("さっさと家に入って"),
            kyoko.deal().d("口を結んでほっぺを膨らませた$childの手を取り",
                "階段を駆け上がる"),
            kyoko.look().d("二階まで登り終えると一度だけ振り返って視線を向けたが",
                "彼は困ったように$meを見上げながら後頭部を掻いている"),
            kyoko.think().d("けれど追いかけてくるような素振りはなく",
                "まるで地縛霊のように動かないでいてくれたので",
                "$meは「行こ」と$childに口早に言って$st_myapartまで急いだ"),
            shota.come(w.stage.apart, w.day.encounter),
            kyoko.deal(shota, w.i.proposed),
            shota.look(w.another),
            kyoko.think(shota, "知りたい"),
            )

def sc_canlook(w: wd.World):
    kyoko, shota = w.kyoko, w.shota
    return w.scene("見える人",
            ).omit()

def sc_mymeeting(w: wd.World):
    kyoko, shota, child, stu = w.kyoko, w.shota, w.child_kyoko, w.student_kyoko
    return w.scene("わたし会議",
            kyoko.be(w.stage.living, w.day.encounter,"スチール製の重い玄関のドアを勢いよく閉めるとしっかりと施錠を確認してから",
                "ドアチェーンも下ろす。",
                "暫く耳を澄ましていればみたけれど",
                "誰の足音も聞こえてこなかった"),
            kyoko.look("$meは安堵の吐息を漏らして$childが駆けて行ったのを見送ると",
                "スニーカーを脱いで買い物袋と鞄を手に上がる"),
            kyoko.think("一体何だったのか"),
            kyoko.deal("冷蔵庫の前にビニル袋に入ったままの買い物を置き去りにして",
                "リビングに行く"),
            kyoko.look("壁に背を預けて本を読んでいる$studentと座り込んでクマのぬいぐるみを手にしている$childは",
                "$meを見て何か言いたそうに唇を尖らす"),
            kyoko.ask("$studentはさっきの人",
                "会ったの？"),
            stu.talk("何？"),
            kyoko.look("彼女は目を細めて$meを見ると",
                "$childの方を見やって舌打ちをする"),
            stu.talk("あんたまた何かしたんでしょ？",
                "$kyokoが怒ってるじゃない"),
            child.talk("$my知らないもん。",
                "$meただあやとりしてただけだもん"),
            stu.talk("だいたい何で外出てたのよ。",
                "$meらここから出ちゃいけないんだよ？"),
            child.talk("なんでよお？"),
            stu.talk("あーんた", "ほんと他人の話聞いてないよね。",
                "なんでじゃなくて",
                "$kyokoに迷惑だから駄目だって何度も説明したでしょ？"),
            child.talk("だってあのお兄ちゃんと遊びたかったんだもん"),
            stu.talk("だーかーらー",
                "そのお兄ちゃんって何？", "誰？",
                "$meは全然知らないし見てもないし話してないから分かんないの"),
            kyoko.look("徐々に語気が強くなり",
                "$studentは遂に立ち上がって$childの前に向かう。",
                "その右手には文庫本がしっかりと握られていて",
                "それを思い切り頭上へと振り上げた"),
            kyoko.think("ゆるして、ください"),
            kyoko.look("頭を抱えてじっと壁際で小さくなる$childは",
                "あの日の$meだった"),
            kyoko.talk("$student",
                "もうそこら辺にしておいて"),
            stu.talk("は？",
                "あんたが最初に言い出したんでしょ？",
                "またこいつが泣くからやめろって言うの？",
                "泣けば何でも許されるの？",
                "$meは泣いたって怒ったって傷つけられたって誰も何一つ守ってくれないってのに！",
                "ちょっと小さいだけで",
                "若いってだけで",
                "贔屓してもらえるなら$meだってずっと若いままでいたいわよ！"),
            kyoko.look("$studentは手にした本を$meに向けていたが",
                "睨みつけようとしている彼女の目は小さく揺れ動き",
                "何かを待っていた"),
            kyoko.deal("$meは小さく溜息を落とし",
                    "黙ってその文庫本を取り上げる"),
            kyoko.look("なんで？",
                    "という彼女の叫びが透けて見えるようだったが",
                    "$meにはどうしてそんな風に煽る真似をしたのかもよく理解できた"),
            kyoko.think("だって$studentは中学三年生の$meだから"),
            kyoko.think("誰かに罰してもらうことを期待して",
                    "相手を試す瞳の底の嘲笑がうっすらと感じられる視線だ。",
                    "本当に怯えているなら決して相手と目を合わせたりなんてしない"),
            kyoko.talk("$meは別に怒ったりしないから。",
                    "ただ事情を知りたいだけなの。",
                    "ね？",
                    "$childも分かるでしょ？"),
            kyoko.look("大きな瞳に涙を浮かべながら小さく頷くと",
                    "一度$studentを見てから足早に$meの隣まで駆けてきて",
                    "左腕に抱きついた"),
            kyoko.talk("$studentは？"),
            stu.talk("ハァ……わかった"),
            kyoko.look("彼女は$meと$childの顔をじっと見てから大きく肩を上下させ",
                    "$meの前に座り直した"),
            kyoko.deal("小さな白い丸テーブルを囲んで",
                    "三角形に並ぶ。",
                    "$meの右側に$student",
                    "左に$childだ。",
                    "いつもこうして何かあると”$i_meeting”を行うようにしていた"),
            kyoko.talk("それじゃあ", "まずは$childから。",
                    "最初にあの男の人を見たのはどこ？"),
            child.reply("うーんと……忘れた"),
            stu.talk("何言ってんのよ。",
                    "あんた呼ばれたらほいほい外に出てっちゃったんでしょ？"),
            kyoko.look("けれど$childは真剣な顔で唇を尖らせると", "ぶんぶんと顔を左右に振る"),
            stu.talk("$kyoko。",
                    "こいつまた嘘言ってる"),
            kyoko.talk("そう決めつけないの。",
                    "ねえ$child。",
                    "ほんとに外から彼に呼ばれて",
                    "ここを出たの？"),
            kyoko.look("その大きな瞳に涙を溜めると",
                    "一度だけ$studentを見てから$meに一つ大きく頷いてくれる"),
            kyoko.ask("じゃあ",
                    "あなたは彼の声を聞いたのね？"),
            kyoko.look("それにも頷いた"),
            stu.talk("だから言ったんだよ。",
                    "こいつ嘘つきだって"),
            kyoko.talk("$student"),
            stu.talk("分かったよ"),
            kyoko.look("不満そうな彼女の口を一旦閉じさせると",
                    "$meはもう一度同じことを$childに尋ねた"),
            child.talk("うん。", "そうだよ。",
                    "$shotaに呼ばれたから外出たの"),
            kyoko.ask("ショータロ？"),
            kyoko.think("あまりに馴れ馴れしくその名を口にしたものだから驚かされたが",
                    "$meの知らないうちに仲良くなったのだろう。",
                    "そうでなくても$childはあまり他人に警戒心を持たない。",
                    "ただ普通は見えないから彼女が近寄って行っても分かる人はいない。",
                    "他人からすれば$childたちは幽霊みたいなものだろう"),
            kyoko.think("それに$me以外の人間がいるような場なら",
                    "彼女たちはすぐに消えてしまうのだ。",
                    "それが彼女らが$i_IFというものだという証拠だった"),
            kyoko.ask("彼の声は$studentも聞いたの？"),
            kyoko.look("ずっと睨むように$meを見ていた$studentは小さく首を横に振ると、"),
            stu.talk("$meは$childが何か声がするからって勝手に外に出て行くのを見てただけ。",
                    "宅急便とかその手のだろうって勝手に思ってたし"),
            kyoko.ask("$meの声以外は出ないでって言ってるのに",
                    "出ちゃってるの？", "いつも？"),
            kyoko.look("$studentは大きく頷き", "$childは目を逸した"),
            kyoko.deal("$meは思い切り額を手で押さえつけて唸り声を漏らす"),
            kyoko.talk("今はそっちはいいわ。",
                    "とにかくあの$shotaっていう彼にはもう二度と近づかないで"),
            child.ask("なんで？"),
            kyoko.talk("どうしても"),
            kyoko.think("見えるはずのない$meの$i_IFを見ることのできる人間が普通のはずはないからだ",
                    "とは彼女たちには説明できなかった"),
            kyoko.talk("お腹空いたでしょ。",
                    "ご飯作るから待ってて"),
            kyoko.move("$meは心の中で溜息を漏らして立ち上がると",
                    "不満そうに見上げる二人を背に",
                    "台所に向かった"),
            )

def sc_saitosan(w: wd.World):
    kyoko, shota, saito, isoya = w.kyoko, w.shota, w.saito, w.isoya
    return w.scene("斉藤さん",
            kyoko.be(w.stage.classroom, w.day.encounter_next),
            kyoko.hear("耳から顎までしっかりと続くモジャモジャの髭を上下させながら",
                "黒板の前で$ln_isoya教授が喉に絡むようなドイツ語の発音を繰り返していた"),
            kyoko.look("$meの隣ではペアになっている$saitoが教科書と先生を交互ににらめっこしながら",
                "同じように小さく発音を繰り返している。",
                "その$meの視線に気づくと恥ずかしそうに笑うのだけれど",
                "今日誕生日なんだと言われて年齢を聞くと実は一つ歳上だったという事実が判明して",
                "なんだかバツが悪い"),
            isoya.talk("ドイツに限らないけどね",
                "語学を学ぶというのは法則や発音", "単語を知るということではなくて",
                "文化を知るってことなんだ。",
                "ほら", "最近は日本に来る外国の人も増えてるけど",
                "ただ観光したいだけでなくて文化を知りたいんだって言ってわざわざ日本語を覚えて訪ねてくれたりする"),
            kyoko.look("周囲の生徒は「また始まったよ」といった感じでスマートフォンを教科書で隠して見始めたりしていたが",
                "彼女は目を輝かせて先生の話を聞いている。",
                "大きな眼鏡に真っ黒でしっかりした髪を耳の後ろで括っていて",
                "$saitoが頷く度にそれが上下して揺れるのが二つの耳みたいに思えてちょっとだけ愛らしく感じる"),
            kyoko.think("そんな彼女が浪人生とは思わなかったから",
                "「なに？」という悪意のない顔で$meを見られるとどう答えていいものか分からなくなる"),
            isoya.talk("知りたいならまず学ぶことだ。",
                "知らないなら", "分からないなら", "本を開くか",
                "あるいは知っている誰かに尋ねることだ。",
                "タテン・シュタット・ヴォルテ。",
                "言葉よりも行動をだよ"),
            kyoko.look("先生は黒板に力強く文字を書くと",
                "そう言って教科書の続きに戻った"),
            )

def sc_withsaito(w: wd.World):
    kyoko, shota, saito, isoya = w.kyoko, w.shota, w.saito, w.isoya
    return w.scene("斉藤さんと私",
            kyoko.go("宿題のプリントを鞄に仕舞い",
                "席を立つ。",
                "今日の授業はこれで終わりだった"),
            kyoko.behav("$meは人が一気に減った教室で",
                "思い切り両腕を持ち上げて伸びをする。",
                "金曜はサークルの集会があるけれど",
                "バイトもあるし",
                "それに昨日のあの$n_shotaとかいう男性のことも気になる"),
            saito.ask("あの"),
            kyoko.think("鞄を手に部屋を出て行こうとした$meの手を",
                "$saitoが掴んだ"),
            kyoko.talk("何ですか？"),
            saito.talk("この後授業入ってますか？"),
            kyoko.look("それはいつも彼女が先生を見る時にしているのと同じ眼差しだった"),
            kyoko.behav("左右に首を振った$meに嬉しそうにすると",
                "彼女は「少しだけ、付き合ってもらってもいいですか？」と断ってから",
                "一緒に教室を出た"),
            kyoko.look("背中にカーキ色のリュックを背負った短い二つ絞りの髪型の$saitoは",
                "鈍い群青色のロングスカートを揺らしながら勢いよく歩いていく。",
                "$meはそれについていくのがやっとで",
                "途中何度か声を掛けられたのだけれど",
                "とても話に答えられるような状況じゃなくて",
                "「うん」とか「ええ」とか相槌を返すので精一杯だった"),
            kyoko.think("誕生日という免罪符があるからなのか",
                "いつもは授業が終わってすぐ別れるだけの存在だった彼女が",
                "違う姿を見せていた"),
            saito.ask("$kyokoはさ",
                "その", "大学で友だちとかできた？"),
            kyoko.talk("えっと……"),
            kyoko.think("そう言われて浮かんだのは$sayamaの顔くらいだった"),
            kyoko.talk("まあサークルの知り合いくらいなら"),
            saito.talk("そうだよね。",
                "$meってさ",
                "浪人してるからか",
                "その",
                "まだ友だちとかここでいなくて"),
            kyoko.look("やっと右隣に追いついた$meにそう言いながら苦笑を向ける。",
                "その化粧気の全くない表情は歳上という感じはない。",
                "寧ろ一年生", "下手をするとオープンキャンパスにやってきた高校生と言っても通用しそうだ"),
            saito.talk("別にいなくても何てことはないんだけど",
                "でも時々困ることもあるんだよね"),
            kyoko.look("それが何だと思う？",
                "という顔を$meに見せてから",
                "彼女は横断歩道の向こう側にあるラーメン屋の看板を指差した"),
            kyoko.ask("え……"),
            saito.talk("ほら。",
                "何て言うか",
                "一人で食べても大丈夫なものと",
                "そうじゃなくて一人で食べると美味しくないものってあるじゃない？"),
            kyoko.ask("それがラーメン？"),
            kyoko.look("$saitoは小さく頷くと",
                    "信号が変わった道路の上の白線を踏みしめて歩き出す"),
            kyoko.move("全然自分とは感性が違う他人がそこにいるのを感じつつ",
                    "$meは諦めたように彼女に続いた"),
            )

def sc_talksteady(w: wd.World):
    kyoko, saito = w.kyoko, w.saito
    return w.scene("恋人の話",
            kyoko.come("今月頭に開店したというラーメン店は三時過ぎという中途半端な時間帯にも関わらず",
                "$meと$saitoの二人分の席が用意できるまでに五分ほど待たされた"),
            kyoko.think("それでも彼女は嫌な顔も失望したような素振りも見せず",
                "それどころか席が空くまでの時間まで楽しいといった雰囲気を$meに見せていた"),
            kyoko.think("その五分程度で$saitoが$meとは違い",
                "ちゃんと目的や動機を持ってこの大学に入ったことを知った"),
            kyoko.ask("茨城からこっちって飛行機ですよね？",
                "夏休みは帰ったりするんですか？"),
            kyoko.move("カウンターの隅の方の席",
                "横並びに掛けながら$meは尋ねる"),
            saito.talk("一年に一度だけって決めてるんで",
                "今年はお盆もこっちで過ごすつもり。",
                "$kyokoは地元なんですよね？"),
            kyoko.behav("鞄を足元の籠に入れながら”地元”という響きにとても居心地の悪さを感じて",
                "$meは曖昧に頷きを返す"),
            saito.talk("だから$kyokoて色白なのかな。",
                "冬はスキーとかスノボとかやられたり？"),
            kyoko.think("彼女が$meにどんなイメージを抱いているのかよく分からない。",
                "たぶん悪意はないのだ。",
                "けれど$meとはまた違った風に人との距離感が分からないのだろう"),
            kyoko.deal("結局$saitoも$meも一番の売れ筋だという豚骨醤油ラーメンを注文して",
                "やってきた黒い丼の中身を見て顔を見合わせた"),
            saito.talk("ちょっと量多そうだね"),
            kyoko.talk("$saitoは大丈夫ですか？"),
            saito.talk("夕食にしちゃえば何とか……なるかな"),
            kyoko.look("たっぷりと汁に浮いた縮れ麺の上に山盛りのモヤシと大きなチャーシューが二枚",
                "他にも海苔にメンマにカマボコが",
                "食べてみろとばかりに汁に浸っていた"),
            kyoko.talk("麺の量", "少なくしてもらえばよかったですね"),
            saito.talk("大丈夫。",
                "一人じゃないから"),
            kyoko.look("そう言って笑顔で蓮華に入れたスープを啜る$saitoは何とも満足そうだ。",
                "$meは湯気を上げる麺を掬い上げて",
                "熱さを我慢しながら脂ごと喉に流し込む。",
                "美味しいけれどやっぱり最後までは食べるのは大変そうだな",
                "という味が胃袋へと落ちていった"),
            w.tag.br(),
            saito.talk("ふぅ……"),
            kyoko.talk("はぁ……もう無理"),
            kyoko.look("何とか最後の麺を胃袋まで押し込んで",
                "$meは$saitoと顔を見合わせる。",
                "互いに額を汗ばませたままほっこりと表情が緩むと",
                "小さな声で笑った"),
            saito.ask("$kyokoは", "その", "いるの？"),
            kyoko.look("何がだろうか？",
                "と彼女の顔を覗き込むと目線を泳がせてから照れたように俯いた"),
            saito.talk("彼氏とか", "そういうの"),
            kyoko.think("$sayamaに冗談で訊かれたりしたことはあったが",
                "こんな風に直球で訊かれるのは大学に来て初めてかも知れない。",
                "全然知らなかっただけで",
                "$saitoはごくごく普通の感性を持った女子なのだ。",
                "好きな男性の話なんかをしてちょっと頬が染まるような",
                "そういう可愛らしいところを持った女性なのだ"),
            kyoko.reply("いませんよ。",
                    "昔からそういうの", "全然縁がないんです"),
            saito.talk("そうなの？",
                    "$kyokoは$meと違ってちゃんと人付き合いしてるし",
                    "他の人たちみたいに化粧バリバリで恐い感じじゃないし",
                    "なんて言うかとても自然体で話し掛けやすいから",
                    "勝手にそういう人いるんだとか想像してて……ごめんなさい"),
            kyoko.look("丼を下げてもらって", "二人とも自分の前にある水の残ったコップを両手で掴んでいる。",
                    "彼女の視線が落ちる水面には",
                    "ちょっとした後悔とかまたやっちゃったなとか",
                    "そういう溜息が映り込んでいるのだろう"),
            kyoko.talk("$meも人付き合いは苦手です"),
            saito.talk("え？"),
            kyoko.talk("仕方なくでやっているだけで",
                    "しなくていいなら一人でいる方がずっと気楽ですから"),
            kyoko.look("分かる。", "という目で彼女は頷く"),
            kyoko.talk("誰かと一緒にいる。",
                    "それも気心の知れない誰かと一緒に暮らすというのは$meにとって",
                    "幽霊に怯えながら暮らすみたいなものなんです。",
                    "だからとても彼氏とかそんなのは……ひぇっ！"),
            kyoko.behav("突然$saitoの手が$meを掴んで妙な声を出してしまう"),
            saito.talk("ごめんね$kyoko。",
                    "誘った時に拒否することなく付いてきてくれたから勝手に大丈夫な人なんだ$meに心を許してくれているんだって",
                    "そんな風に思い込んじゃって。",
                    "ほんとはラーメンなんか食べたくなかったんでしょ？",
                    "それも語学の授業でペアになっただけのうっすい関係性の$meなんかと二人きりでなんて",
                    "美味しいラーメンの味も不味くなっちゃったよね？"),
            kyoko.look("今にもカウンターに突っ伏して泣き出すのかと思うような勢いだ"),
            kyoko.look("$meは「そんなことないですよ。美味しかったですから」と店内の他のお客さんや二の腕逞しい店員さんたちを見やりながらそう言うと",
                    "早く会計を済ませようと席を立った"),
            )

def sc_hisvisit(w: wd.World):
    kyoko, shota, child, stu = w.kyoko, w.shota, w.child_kyoko, w.student_kyoko
    return w.scene("彼の再訪",
            kyoko.move("バイトのスケジュールはしっかり確認していたはずだったのに",
                "今日ではなく明日だった。",
                "そんな落胆と共に自転車のペダルを踏み込みながら",
                "夕焼けが去った空を見上げる"),
            kyoko.think("結局あれから$saitoとメールアドレスを交換して",
                "形だけは友だちということになった。",
                "少しだけ心が軽いのは彼女がスマートフォンではなく所謂ガラケーで",
                "ＬＩＮＥはやっていなかったからだろう"),
            kyoko.think("ちなみに$saitoは少し筋肉質の長身男性が好みらしい。",
                "それを聞いてから$meの頭の中では$ln_matsumotoと並んで歩く彼女の姿を想像してしまい",
                "必死に一人で喋り続ける$saitoに呆れつつも隣で適当に相槌を打ってあげている彼を勝手に作り上げて",
                "そんな優しい一面を持っていてくれたら苦手意識も無くなるかも知れない",
                "なんて自分勝手な思いが湧き上がってしまった"),
            kyoko.go(w.stage.apart,
                "路地を曲がり",
                "アパートが見えてくると少し速度を緩める"),
            kyoko.look("その$meの視界に",
                "軽く手を挙げてみせるあの男の笑顔が", "割り込んだ"),
            kyoko.meet(shota),
            kyoko.deal("思わず急ブレーキを掛けて止まると",
                "振り返って彼がいた外灯の下を見る"),
            shota.talk("こんばーんは"),
            kyoko.look("丈の短いズボンのポケットに手を戻すと",
                "そう言って", "ニッと笑う"),
            kyoko.look("悪意の欠片もない子どもの笑顔だ。",
                "よく$childもする。",
                "けれどその無垢さが一番害になることだって多々あった"),
            kyoko.ask("何か用ですか？"),
            kyoko.look("できるだけ冷たく言い放ってみたけれど",
                "彼は慄いた様子もなく楽しげに歩いて近づくと",
                "$meの周囲の匂いを嗅ぎ取る"),
            kyoko.ask("な、何なのよ？"),
            shota.talk("魚臭い"),
            kyoko.talk("鮭買ったのよ。",
                "焼こうと思って……ちょっと！"),
            shota.ask("三匹？"),
            kyoko.think("いつも三人分を購入するのが癖になっていた"),
            kyoko.reply("冷凍しておくから"),
            shota.ask("$kyokoって嘘を付く時ちょっと上を向いて鼻を膨らますよね"),
            kyoko.think("それは$studentに言われて初めて気づいた自分の癖だった"),
            kyoko.ask("なんであなたがそんなこと知ってるの？"),
            kyoko.look("彼は目を細めて笑ってから背を向けると、"),
            shota.talk("なんで？",
                "って言いたいのはこっちなんだけどなあ"),
            kyoko.look("クスクスと声を漏らしながら外灯のスポットライトに入り",
                "くるり", "と$meを振り返った"),
            shota.talk("$kyoko", "忘れちゃった？",
                "それとも記憶から消したの？",
                "大事な約束のこと"),
            kyoko.think("やくそく。",
                    "と心の中で復唱する"),
            kyoko.look("$meの二十年余りの人生のアルバムには一枚も彼が写った写真なんてない。",
                    "それなのに混じり気のない純粋な笑顔は",
                    "確かに見覚えがある"),
            kyoko.ask("いつ頃の話なの？",
                    "$me", "実はいくつか記憶が抜けている時期があるの。",
                    "もしその時の$meと出会って何か約束をしたというなら",
                    "その$meは$meじゃないから"),
            kyoko.look("自分でも何を言っているのだろうとは思う。",
                    "彼は小首を傾げ", "$meの表情を覗き込むように視線を投げている"),
            kyoko.talk("あなたに説明しても分からないと思うけど",
                    "$meってね",
                    "他人とはちょっと違うの。",
                    "ちょっとだけおかしいところがあるの。",
                    "昨日あなたが見たという女の子。",
                    "彼女は現実には存在しないの。",
                    "でも$meはそういうものが見える。",
                    "見えないものが見えるのよ"),
            shota.ask("幽霊ってこと？"),
            kyoko.talk("違うけど", "でも似たようなもの。",
                    "本来なら$me以外には見えないものなのよ", "彼女たちは"),
            shota.ask("たち？", "他にもいるの？"),
            kyoko.think("喋りすぎた。",
                    "追い払おうとして饒舌になりすぎた"),
            kyoko.think("よくやる失敗だった。",
                    "こういう時に人付き合いの不慣れさというものが露呈し易い。",
                    "それも相手が異性なら尚更だ"),
            kyoko.move("$meは「とにかくごめんなさい」とだけ言って",
                    "自転車を押してアパートの駐輪場に向かう"),
            shota.talk("何か気分を害したなら謝るよ。",
                    "そうじゃなくてさ",
                    "今日は大事な話があって来た"),
            kyoko.look("彼は駆け寄ってきて$meの隣に並ぶと",
                    "前籠から買い物袋と鞄を引き抜いて持ってくれる"),
            kyoko.talk("帰ってくれた方がありがたいんですけど"),
            shota.talk("話を聞いてくれたら帰る"),
            kyoko.think("迷惑だな",
                    "と感じているのに",
                    "その人懐こい笑顔の所為か",
                    "不思議と危険を感じない"),
            kyoko.think("そもそも普段ならこんな近くに全然知らない男性がいたらすぐ走って逃げ出したくなる"),
            kyoko.look("横並びになると彼が$meとそう差のない背丈であることがよく分かる。",
                    "少なくとも百七十はない。",
                    "$ln_matsumotoのように筋肉質という訳でもなく",
                    "色白で猫のような柔らかい髪の毛をしていた"),
            kyoko.deal("自転車を停めると",
                    "$meは彼に向かって手を差し出す"),
            kyoko.talk("それ", "返して下さい"),
            shota.talk("部屋まで持ってくけど？"),
            kyoko.talk("そんなことしたらあなたを入れないといけないでしょう？",
                    "小さい頃に教わらなかったんですか？",
                    "知らない人を勝手に家に上げてはいけないって"),
            kyoko.look("小さな男の子に言い聞かせるような口ぶりになってしまったけれど",
                    "しゅんと俯いた彼にはこちらを保育士のような気にさせる趣があった"),
            shota.ask("$kyokoって", "そういうとこあるよね"),
            kyoko.talk("それとね",
                    "どうして$meのこと名前で呼び捨てにするの？",
                    "それがまず失礼だとか思わないんですか？"),
            kyoko.look("けれど彼は首を捻る。",
                    "他人に対して失礼という感覚がないのかも知れない。",
                    "もしそうなら本当に子供心のまま大きくなってしまった人間なのだろう"),
            kyoko.talk("とにかく返して下さい"),
            kyoko.deal("$meはいつまでも手にしたそれを離そうとしない彼から奪い取ろうとしたが",
                    "そんな$meと彼の間に$childが駆け込んできた"),
            kyoko.ask("ちょっと！"),
            child.talk("$shota！"),
            shota.talk("$child。", "こんばんは"),
            kyoko.look("不意に彼の声が柔らかくなる。",
                    "$childも「こんばんは」と返して", "その足元に抱きついた"),
            kyoko.talk("ねえ$child。",
                    "$meがちょっと怒ってるの", "分かる？"),
            kyoko.look("恐い顔をした訳ではなかったけれど",
                    "眉を曲げて困った表情で彼女は唇を尖らせる。",
                    "駄々をこねる時の仕草だ"),
            kyoko.talk("$child。",
                    "そもそもなんで外に出てきたの？",
                    "$me以外の前に出ちゃ駄目だっていつも言ってるでしょ？"),
            kyoko.look("怯えた目だ。",
                    "ぎゅっと彼に抱きついて",
                    "その顔をお腹に押し付ける"),
            shota.talk("事情はよく分からないけどさ",
                    "こんな小さな子にそこまで言うことないんじゃないかな？"),
            kyoko.talk("事情はさっき話した通りです。",
                    "だいたいどうしてあなたに$childが見えるんですか？",
                    "あなたに見えちゃいけないものなんですよ？"),
            shota.talk("そんなこと言われてもなあ……ねえ"),
            kyoko.look("彼は苦笑して$childを見る。",
                    "どう見ても本当に彼にはあの子が見えているとしか考えられない"),
            kyoko.think("今までこんな風に他人が$meの$i_IFを見ていたことはなかった。",
                    "先生にだってそういうものだと説明されたし",
                    "彼女たちが幽霊やそういう訳の分からない存在ではないということをやっと受け入れて生活を続けていたのに",
                    "それを今",
                    "目の前のあどけない笑顔の彼が",
                    "破壊している"),
            kyoko.feel("$meは唇の震えを感じた"),
            kyoko.think("なんで。",
                    "もうずっと来なくなっていたのに"),
            kyoko.behav("しゃがみ込み",
                    "耳を塞ぐ"),
            shota.talk("どうしたの$kyoko？", "大丈夫？"),
            kyoko.talk("時々こうなるの。",
                    "お願い。",
                    "今日はもうそっとして……あっ"),
            kyoko.feel("ドサリ", "という袋が地面に落ちた音に続いて",
                    "$meの体を何か温かいものが包み込む"),
            kyoko.look("目を開いて顔を上げると",
                    "彼がそっと背中まで優しく腕を回しているのが分かった"),
            kyoko.talk("あの"),
            shota.talk("大丈夫だよ。",
                    "$kyokoは何も悪くないから。",
                    "$meがついてる"),
            kyoko.think("不思議だ。",
                    "拒否したいのに",
                    "その温もりが心地良い"),
            kyoko.feel("心地良いだけならまだしも",
                    "段々と脳が眠っていく。",
                    "ぼんやりとして",
                    "視界が薄れていく"),
            kyoko.think("誰も助けてくれないのに",
                    "こんなところで落ちてはいけない"),
            kyoko.think("何度そう思って意識を取り戻そうとしても",
                    "ずぶ濡れになったあの日みたいに体は重くてどうしようもなく",
                    "腕も足も感覚がなくなって",
                    "$meは沈んでいった"),
            )

def sc_hispropose(w: wd.World):
    kyoko, shota, child, stu = w.kyoko, w.shota, w.child_kyoko, w.student_kyoko
    return w.scene("プロポーズ",
            # TODO: 翔太と同棲することに
            # TODO: 本気のプロポーズ、三番目誕生
            )

def sc_birthnew(w: wd.World):
    kyoko, shota, child, stu = w.kyoko, w.shota, w.child_kyoko, w.student_kyoko
    return w.scene("三番目の今日子",
            )

# episodes
def ep_intro(w: wd.World):
    return (w.chaptertitle("ワタシが見える人"),
            sc_visited(w),
            sc_canlook(w),
            )

def ep_rebellion(w: wd.World):
    return (w.chaptertitle("ワタシと斉藤さん"),
            sc_mymeeting(w),
            sc_saitosan(w),
            sc_withsaito(w),
            )

def ep_confess(w: wd.World):
    return (w.chaptertitle("彼の告白"),
            sc_talksteady(w),
            sc_hisvisit(w),
            sc_hispropose(w).omit(),
            sc_birthnew(w).omit(),
            )

# outline
def base_info(w: wd.World):
    return ("chapter2", story(w), w.kyoko, w.shota)

def story_outline(w: wd.World):
    return [
            ("chapter2", story(w),
            w.kyoko.think(w.shota, "知りたい"),
            w.shota.look(w.another),
            w.kyoko.meet(w.shota),
            w.kyoko.deal(w.shota, w.i.proposed),
            True),
            ]

# main
def story(w: wd.World):
    return [w.maintitle("わたしと彼"),
            ep_intro(w),
            ep_rebellion(w),
            ep_confess(w),
            ]


def main(): # pragma: no cover
    from src.anotherme.story import world
    w = world()
    return w.build(story(w))


if __name__ == '__main__':
    import sys
    sys.exit(main())

