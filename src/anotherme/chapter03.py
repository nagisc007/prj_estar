# -*- coding: utf-8 -*-
"""Story: chapter 03: The another me
"""
import os
import sys
sys.path.append(os.path.join(os.path.dirname(__file__), '../..'))
sys.path.append('storybuilder')

from storybuilder.builder import world as wd
from src.anotherme import config as cnf
THM = cnf.THEMES


# scenes
def sc_proposed(w: wd.World):
    kyoko, shota, child, stu = w.kyoko, w.shota, w.child_kyoko, w.student_kyoko
    return w.scene("彼のプロポーズ",
            kyoko.be(w.stage.living, w.day.proposed),
            kyoko.look("楽しそうな$childたちの笑い声に",
                "$meはゆっくりと目を開く"),
            kyoko.think("また布団の上で飛び跳ねたり",
                "好き勝手に押入れから物を引っ張り出してばらまいたりしているのだろう"),
            kyoko.look("そんな思いでぼんやりとした視界の中に何人かのシルエットを捕まえる。",
                "小さなのは$childだ。", "まだ十歳だった頃の$meの$i_IF", "$i_imagefriend。",
                "他にもう一人",
                "壁を背もたれに本を読んでいる$studentは十五歳の自分。", "彼女もまた$i_IFだった"),
            kyoko.talk("あれ？"),
            kyoko.look("$meは三人目の存在を確認して",
                "慌てて上半身を起こす"),
            shota.talk("あ", "起きた？"),
            kyoko.look("そう言って笑顔を見せたのは",
                "もう一人の$meではなく",
                "あいつ", "$n_shotaだった"),
            kyoko.ask("どうして家にあなたが入っているの？"),
            shota.talk("覚えてない？",
                "急に$kyokoが倒れたからここまでみんなで運んできたんだよ？",
                "ねえ"),
            child.talk("うん！"),
            kyoko.look("$childも$studentも一様に頷いている"),
            kyoko.think("右のこめかみ辺りの痛みを手で押さえながら",
                "意識が無くなる前のことを必死に思い出そうとするけれど",
                "うまく考えられない"),
            kyoko.ask("それは嘘よ。",
                "この子たちにはそんなことできないわ"),
            kyoko.think("$i_IFは単なる$meの幻想だ"),
            kyoko.look("不安そうに見つめている十歳の小さな$meである$childも",
                "腕組みをして険しい目線を向けている十五歳の$meである$studentも",
                "どちらも$meの想像上の友だちでしかない。",
                "だから彼女たちに$meをどうこうする力はないのだ"),
            shota.talk("$kyokoはさ",
                "もうちょっと他人の言葉に耳を貸した方がいいよ"),
            kyoko.look("マッシュルームカットが実に馴れ馴れしく「$fn_kyoko」と呼び",
                "$meに苦笑を向ける"),
            kyoko.reply("他人の家に無断で上がり込むような失礼に",
                "そんな説教してもらいたくないです。",
                "もう$meは大丈夫なんで出て行ってもらっていいですか？"),
            kyoko.think("上半身を起こして彼を睨むようにする。",
                "握った右手を心の中では思い切り相手にぶつけていたが",
                "流石にそこまでするほどの元気も勇気もない"),
            shota.talk("緊急事態だから仕方なかったんだけどな"),
            kyoko.look("彼はそうぼやいて立ち上がると",
                "玄関の方に向かって大きく一歩を踏み出す。",
                "だがその動きをすぐに止め",
                "起き上がろうとする$meに振り返った"),
            shota.talk("出ていくけどさ",
                "その前に一つだけ確認させてもらいたいんだ"),
            kyoko.ask("何？"),
            kyoko.look("見上げた$meに笑みを向けると",
                    "彼はわざわざ「$n_kyokoさん」と前置きをしてから",
                    "こう口にした"),
            shota.talk("二十歳になったら$meと結婚をするという約束について",
                    "正式に返事が欲しいんです。",
                    "できれば近日中に"),
            kyoko.feel("その混じり気のない悪意に",
                    "$meの目の前は再び暗がりを求めた"),
            kyoko.deal(shota, w.i.proposed, w.stage.apart, w.day.proposed),
            shota.deal(w.i.proposed),
            kyoko.think(w.i.proposed),
            )


def sc_favor(w: wd.World):
    kyoko, shota, child, stu = w.kyoko, w.shota, w.child_kyoko, w.student_kyoko
    return w.scene("夏風邪",
            # TODO: 日の変わり目が分かるように修正
            kyoko.be(w.stage.living, w.day.favor),
            kyoko.think("翌朝になってもまだ夢の中を彷徨っているような気分だった"),
            kyoko.feel("布団を首元まで被ったまま天井を見上げる"),
            kyoko.look("ぼうっとしたままの頭で",
                "何度も彼が口にした約束の内容がリフレインした"),
            stu.ask("ねえ。", "今日バイトあるんでしょ？",
                "大丈夫なの？"),
            kyoko.look("$studentは本を手にしたまま", "先程からずっとページを捲らずに$meに何度も「大丈夫？」と呼びかける"),
            kyoko.reply("大丈夫よ。", "三十八度とか平熱から二度高いだけじゃない。",
                "昼から三時間だけ我慢できればいいから"),
            kyoko.deal("枕元の時計に腕を伸ばす。",
                "なかなか届かないなと思っていたら、"),
            child.talk("はい"),
            kyoko.deal("$childが渡してくれた"),
            kyoko.talk("ありがとう"),
            kyoko.look("彼女の癖のある髪を少しだけ撫でてやり",
                "改めて時刻を確認する。",
                "十一時を過ぎていた"),
            kyoko.deal("何か食べておこうと起き上がろうとするが",
                "額の上に乗せた濡らしタオルが随分と重い"),
            kyoko.think("それでも起きなきゃ", "という無駄な使命感だけが体を起こさせた"),
            kyoko.behav("立ち上がろうとすると目の前が明滅してふらついたから",
                "四つん這いになって何とかキッチンに向かう。",
                "冷蔵庫にスポーツドリンクのペットボトルがまだ一本残っていたはずだ"),
            kyoko.feel("息が熱い"),
            kyoko.think("朝からまた体温が上がったのだろうか。",
                "解熱剤は飲んだけれど",
                "目が覚める度に全然効いていないとしか思えない"),
            kyoko.think("喉が甘くて冷たいバニラの風味を求めた"),
            kyoko.remember("小さい頃からよく熱を出した。",
                "もともと風邪にかかりやすかったのもあるが",
                "その日だけは母お手製のバニラアイスを食べることができたからだ"),
            kyoko.remember("台所で母親がホイップクリームを作るのにカンカンという子気味良い音がずっとしていて",
                "それが聞こえなくなってから二時間ほど待つと",
                "冷たくて黄色がかったアイスが器に盛られて出された。",
                "それをスプーンで掬って口に含むと",
                "火照った顔からすうっと熱が溶けて消えてしまう"),
            kyoko.think("苦手な母親がそんな風に風邪の時だけは",
                "怒ったり喚いたりせず",
                "ただ黙々と$meだけの為に作ってくれたアイスクリームは",
                "こうして親元を離れて一人暮らしをするようになってから",
                "ただ一つ永遠に手に入らないものだった"),
            kyoko.look("冷蔵庫を開けると漏れ出した冷気が額に心地良い"),
            kyoko.talk("あった"),
            kyoko.deal("寝かせて入れてあったボトルを見つけ",
                "それを引っ張り出してキャップを何とか開けると",
                "一気に喉に流し入れた"),
            kyoko.hear("何度目かの喉のゴクリという音を聞いた時",
                "インタフォンが鳴らされた"),
            kyoko.think("こんな時に。",
                "という思いを抱えながら返事をすると",
                "ドア越しに聞こえたのは、"),
            shota.talk("$meだよ。", "$kyoko"),
            kyoko.think("今すぐ帰れと腹の底から声を出したいくらいのこちらの気持ちを微塵も考えていない",
                    "脳天気な彼の声だった"),
            )

def sc_withshota(w: wd.World):
    kyoko, shota, child, stu = w.kyoko, w.shota, w.child_kyoko, w.student_kyoko
    return w.scene("翔太郎と二人きり",
            kyoko.be(w.stage.living),
            kyoko.look("布団に横になる$meを",
                "$n_shotaは心配そうに覗き込みながら",
                "彼の背中にまとわりつく$childをあやしていた"),
            shota.talk("風邪ならバイト休んだ方がいいよ。",
                "$meが電話しようか？"),
            kyoko.talk("やめて"),
            kyoko.feel("いつもの十分の一くらいの小さな声で言うと",
                "$meは肩を大きく動かして呼吸をする。",
                "怠いより辛いより",
                "とにかく黙っていて欲しい。",
                "今考えられることはただそれだけだ"),
            shota.ask("せめて誰か友だちとかに来てもらいなよ。",
                "寝てれば治るとか思ってるかも知れないけど",
                "風邪をこじらせて死んじゃったりする人もいるから",
                "あまり簡単に考えてちゃ駄目だよ", "$kyoko"),
            kyoko.feel("わかってる。", "と声にすることすら億劫だ"),
            kyoko.deal("もういいから帰って",
                "と布団から出した左手を彼の膝に押し付けてみるけれど",
                "「なに？　何か食べたい？」とにこやかな表情が返ってくるだけで",
                "$meの意図は全然汲んでくれない"),
            kyoko.look("諦めたように目を閉じた$meに",
                "彼はぽつりぽつりと自己紹介のような話を始めた"),
            shota.talk("小さい頃は$meもよく風邪を引いたり熱を出したりするような子だった"),
            kyoko.hear("その声は普段彼が話す時のようにやや高めの元気なものではなく",
                "落ち着いて",
                "聞いているとすっと耳馴染みのする優しい音質だった"),
            shota.talk("熱が少しでもあると両親がすぐ学校を休ませて",
                "部屋に閉じ込もって一日や二日を過ごすことになる。",
                "$meはそれが嫌でさ",
                "こっそりベランダから外に出て",
                "ロープを使って庭に降りるんだ"),
            kyoko.ask("二階？"),
            shota.talk("そうそう。",
                "あれって今思えば子供の力でよく解けないように結べたよなあ。",
                "軽かったから大丈夫だっただけかな"),
            kyoko.look("彼はくしゃっと笑うと",
                "ボウルに入れた氷水にタオルを浸してそれを絞る"),
            shota.talk("父親がこれをするとさ",
                "雑に絞れてなくて",
                "額に置いたらべちゃっとなるもんだから",
                "部屋を出て行ってからわざわざ絞り直すことになるんだよ"),
            kyoko.deal("タオルより先に額に置かれた彼の手が冷たくて", "心地よい"),
            kyoko.think("苦しい時に誰かが傍にいてくれる。",
                "それも$childや$studentといった$meの$i_IFでない誰かが世話をしてくれる"),
            kyoko.think("ただそれだけのことなのに",
                "心が弱っているからか", "こんなにも安心の中にいられて",
                "$meは小さい頃の気分を思い出した"),
            kyoko.look("$childが$meの隣にひっついて横になっている"),
            kyoko.deal("その額にきつく絞ったタオルを置いて",
                    "ひんやりとした手が頬や首筋に当てられる"),
            kyoko.talk("おかあさん"),
            kyoko.deal("か細い声を上げ", "そのひんやりとした手を小さな手で包み込もうとする。",
                    "普段なら「やめて」と声が投げつけられるのに",
                    "この日だけは許してくれる。",
                    "手をただ握るだけで",
                    "心までも落ち着いて安心が広がる", "その感覚が大好きだった"),
            shota.talk("どうして母親はいつもきちんとタオルを絞れたんだろう。",
                    "あれって誰かに教わったのかな？"),
            child.reply("おかーさん"),
            kyoko.deal("$meの代わりに小さな$childが答える"),
            shota.talk("じゃあ", "濡れタオルの絞り方はずっと親子で受け継いでいくものなんだね。",
                    "うん。", "きっとそうだ"),
            kyoko.hear("彼の満足そうな声に続いて",
                    "$meのお腹の上に手が置かれる。",
                    "うっすら目を開くと$shotaの手だった"),
            kyoko.look("女性のような毛のないつるりとした手と",
                    "ちんまりとした五本の指。",
                    "それが$meのお腹の上を軽く叩く"),
            shota.talk("$meが寝ているとね",
                    "こうやって傍にやってきて手を置いてくれて",
                    "即興で作ったお話をしてくれたんだ。",
                    "まあいつも決まって小さな男の子か女の子が主人公の",
                    "友だちを作る話だったんだけど"),
            kyoko.ask("どんな？"),
            kyoko.think("風邪の時に少しだけ優しくなる$meの母親だったけれど",
                    "そんな風にお話をしてくれたりはしなかった。",
                    "絵本を読み聞かせてもらった記憶もなく",
                    "図書館に行ってもいつも一人で本を探して読んでいた気がする"),
            kyoko.think("だから少しだけ", "彼の話が気になった"),
            shota.talk("そうだな……例えば",
                    "そう。",
                    "砂場で一人の男の子が遊んでいました。",
                    "けど夕方になっても誰も彼を迎えに来ません。",
                    "そしてブランコで遊ぶ一人の女の子がいて",
                    "彼女も誰も迎えに来ませんでした"),
            kyoko.hear("声のリズムが心地良い"),
            shota.talk("いつまでも迎えに来ないので",
                    "男の子は女の子に尋ねます。『まだ帰らないの？』と"),
            kyoko.feel("それは子守唄のようにも聞こえて"),
            shota.talk("女の子は『ママもパパも忙しいから』と答えたので",
                    "男の子は彼女の両親が迎えに来るまで",
                    "そこで一緒に遊んであげることにしました……あれ？",
                    "寝ちゃった？"),
            kyoko.think("まだ寝てない",
                    "と答えようとしたところで",
                    "急に意識が途切れた"),
            )

def sc_hispresent(w: wd.World):
    kyoko, shota, child, stu = w.kyoko, w.shota, w.child_kyoko, w.student_kyoko
    return w.scene("彼のお土産",
            kyoko.feel("ぺた", "と小さな手が$meの右頬に当てられた"),
            kyoko.ask("何？", "$child……"),
            kyoko.look("目を開けると既に窓の外が暗い。",
                "カーテンは閉め切ってなかったから",
                "遠くにビルの明かりが見切れていた"),
            kyoko.talk("あ……"),
            kyoko.look("すぐに眉を顰めている$childの顔が視界に入り",
                "それから目線を部屋の隅にいる$studentへと向けた"),
            kyoko.ask("どうしよう", "バイト……"),
            stu.talk("ちゃんと断ってたよ……あいつが"),
            kyoko.think("あいつ"),
            kyoko.look("その言葉に$studentと$child",
                "二人の顔をじっと見たが",
                "その間にあったもう一つの顔が消えていることに気づいた"),
            kyoko.ask("$shota？"),
            kyoko.look("自信のなさそうな呟きに二人ともが大きく頷いて答えた"),
            kyoko.look("$meは枕元に落ちていたタオルがもう温くなっていることを知り",
                "布団を抜け出す"),
            kyoko.ask("いつ頃？"),
            kyoko.think("感謝の言葉の一つも彼に返していないことを申し訳なく感じて",
                "$meはふらつく足を押さえて玄関に向かおうとする。",
                "けれどその手を$studentが掴んだ"),
            stu.talk("ずっと前に帰ったから確かめるだけ無駄だよ"),
            kyoko.talk("そっか……彼って", "一体何なんだろう"),
            kyoko.think("案外好い人なのかも知れない"),
            kyoko.think("そう感じて不意に脳裏に浮上した彼は、"),
            shota.talk().emphasis("二十歳になったら$meと結婚をするという約束について",
                    "正式に返事が欲しいんです。",
                    "できれば近日中に"),
            kyoko.remember("そんなことを言っていたと思い出す"),
            stu.ask("なに顔赤くしてんの？"),
            kyoko.reply("また熱が上がったんじゃない？"),
            kyoko.move("そう$studentに答えて背を向けると",
                "冷蔵庫まで歩いてドアを開けた。",
                "ひんやりした空気が火照った顔に優しいが",
                "あまり買い置きをしていないので中身は寂しい"),
            kyoko.talk("あれ？"),
            kyoko.deal("$meは妙に思って今一度枕元に視線を向けた。",
                "そこにはすっかり融けてしまっているが氷水を入れたボウルと",
                "その脇に空になった清涼飲料水のペットボトルがある"),
            kyoko.look("けれどそれとは別のペットボトルが二本",
                "サイドポケットに入れられていた。",
                "他にも買った覚えのないチョコレートに林檎が目立つ場所に鎮座していて",
                "おまけにカップアイスのバニラまで置いてある"),
            kyoko.deal("そのカップを手に取るとまだ冷たくて",
                "それでも蓋の周囲はしっかり汗をかいていて",
                "開けると縁から溶けかかっていた"),
            kyoko.talk("$shota？"),
            kyoko.look("思わず口に出して$childと$studentを見たけれど",
                "彼女たちはどちらも分からないといった様子のきょとんとした表情だった"),
            )

def sc_strangeteam(w: wd.World):
    kyoko, shota, child, stu = w.kyoko, w.shota, w.child_kyoko, w.student_kyoko
    sayama, kunugi, matsu, saito = w.sayama, w.kunugi, w.matsumoto, w.saito
    return w.scene("幸子と松本と",
            kyoko.be(w.day.volunteer).d("休日の円山公園には一週間ぶりの日差しの所為か",
                "人が多い"),
            kyoko.look("$meは病み上がりの中", "何とか風邪薬を飲んでマスク姿で$sayamaたちの後ろの木陰に立っていた"),
            sayama.talk("別に休んでも良かったのにさ"),
            kyoko.talk("倒れるほどじゃないから"),
            kyoko.look("$n_sayamaは心配そうに$meを見たけれど",
                "ゴミ袋と火バサミを持って現れた$kunugiたちの姿に姿勢を正して頭を下げた"),
            sayama.talk("おはようございます", "先輩"),
            kunugi.talk("おはよう$sayama。",
                "みんな来てる？"),
            kyoko.look("先輩は人差し指を立てて人数を確認しているが",
                "足りなかったのか周囲をきょろきょろとする"),
            kyoko.look("$sayamaはブルーのショートパンツにオレンジのパーカーという",
                "どう見ても軽いレジャーに参加しますという格好だけれど",
                "先輩たちも$meも下はズボンで上も薄手の長袖のシャツといった地味な服装だ。",
                "それでも$kunugiだけは何だかそれが様になって見える。",
                "体型なのか立ち姿なのか",
                "ちょっとした仕草も決まっていて",
                "やはり憧れが湧いてくる"),
            kunugi.talk("あと二人だね……ああ",
                "こっちだよ$matsumoto"),
            kyoko.look("大きく手を振った先輩の視線の先を振り返ると",
                "黒のタンクトップを着た大男と",
                "その三歩ほど後ろにちんまりと俯いて歩いてくる二人の姿が見えた。",
                "一人は確かに$matsumotoだったが",
                "もう一人",
                "暑そうな白のふわりとしたブラウスを羽織ったデニム地のロングスカートの眼鏡の女性は",
                "どうやら$meのよく知る人物らしい"),
            kyoko.look("こちらに気づくと表情をぱっと明るくして",
                "小走りになって$matsumotoを追い抜いてやって来る"),
            saito.talk("来ちゃった", "$kyoko"),
            kyoko.talk("$saito……どうして？"),
            kyoko.look("小息を切らせて$meの右隣まできて腕を取ると",
                "彼女は悪びれた風もなく「同じサークルに入ったの」と答える"),
            kyoko.look("その言葉に$sayamaは「だれ？」と目線を投げて寄越したけれど",
                "$meは彼女のことを説明する気力がどうしても湧かず",
                "ただ曖昧な苦笑を返した"),
            kunugi.talk("あ、そうそう。",
                "彼女", "$n_saitoさんだけど",
                "我が$i_cir_nameに入部してくれることとなりました。",
                "拍手"),
            kyoko.deal("紹介の声の大きさに顔を赤くして俯きながらも彼女は",
                "$meの隣で疎らな拍手を受ける"),
            kunugi.talk("自己紹介はまた次の例会でやるとして",
                "今日はそうね……$kyokoと一緒に活動して"),
            saito.reply("は、はい。", "分かりました"),
            kyoko.look("宜しくね", "と小声で付け加えて$meに会釈をする$saitoに色々と尋ねたいことがあったが",
                "$kunugiたちが班分けをし始めたので",
                "黙ったままその動向を見守った"),
            kunugi.talk("それじゃあ$kyokoと$saito",
                    "それにあと$matsumoto。",
                    "その三人で東側回ってきて"),
            kyoko.reply("……はい"),
            kyoko.deal("$kunugiからゴミ袋と火バサミを受け取りながら",
                    "内心ではどうして$matsumotoなのだろうと文句がもたげた"),
            matsu.ask("あの"),
            kunugi.ask("何だ$matsumoto？"),
            matsu.ask("不慣れな$meと$saitoのお守りを病み上がりの彼女に任せるの",
                    "流石にアレなんじゃないすかね"),
            kyoko.look("普段なら誰も口答えしようとしない$kunugiに対して臆することなく言った彼の",
                    "ちょんと伸びた顎髭が何だか逞しく見える"),
            kunugi.talk("良い着眼点だな$matsumoto。",
                    "だが女性ばかりになるより男性が混ざっていた方が色々と面倒なことがない。",
                    "そうでなくとも二人とも声掛けられ易そうなタイプなんだから",
                    "強面一人つけるのは当然だろう？"),
            kyoko.think("先輩に言われると説得力がある"),
            kyoko.look("ただ強面と言われた当の本人は$meたちを見てから自分を指差して沈黙の抗議をしていた"),
            kunugi.talk("それじゃあ一時間後に再びここに集合ね。",
                    "何かあればＬＩＮＥに……$kyokoたちは電話でもいいけど",
                    "$matsumotoに連絡係やらせてもいいよ"),
            kyoko.look("はいはい", "といった体で彼は頭を掻く素振りを見せると",
                    "$meと目線が合って何故か軽く会釈をした。",
                    "よろしく", "の意だろうか"),
            saito.talk("けど良かったあ"),
            kyoko.move("先輩の「開始」という声でバラバラと班に分かれて歩き出すと",
                    "すぐに$saitoが隣にやってきて安堵の息を漏らす"),
            kyoko.ask("よく$meが$i_circleだって知ってましたね"),
            saito.reply("教えてくれたの$kyokoだよ？",
                    "だって昨日話してくれたじゃない？"),
            kyoko.think("え？"),
            saito.talk("だから$me", "思い切って$kunugiに連絡して今日入れてもらった訳だし"),
            kyoko.think("彼女が嘘を言っているようには見えなかったから",
                    "$meは余計に混乱する。",
                    "昨日は風邪で寝込んでいたから覚えていないだけだろうか"),
            kyoko.look("$meは携帯電話を取り出して",
                    "慌てて履歴を確認する"),
            matsu.ask("なあ。",
                    "それって$meが持った方がいいよな？"),
            kyoko.ask("え？"),
            kyoko.look("急に頭の上から低い声がして驚いたけれど",
                    "$matsumotoがすっと手を出して$meからゴミ袋と火バサミを取ってくれた"),
            kyoko.talk("ありがとう"),
            kyoko.look("おう。",
                    "ただそれだけを返して$meと$saitoの前に出ると",
                    "彼は一人で足元のゴミを拾いながら歩いていく"),
            kyoko.deal("$meは途中だった電話の確認をしてそこに$saitoからの着信履歴があるのを見つけると",
                    "立ち止まって空を見上げた。",
                    "真っ白だ。",
                    "雲が広がっている"),
            saito.talk("どうかした？"),
            kyoko.look("いつまでも歩き出さない$meに当の$saitoが声を掛ける。",
                    "彼女に視線を向けた$meは軽く首を横に振ると",
                    "一人でゴミ拾いをしながら進んでいく大男の背中を小走りで追いかけた"),
            )

def sc_talksteady(w: wd.World):
    kyoko, shota, child, stu = w.kyoko, w.shota, w.child_kyoko, w.student_kyoko
    sayama, kunugi, matsu, saito = w.sayama, w.kunugi, w.matsumoto, w.saito
    return w.scene("付き合うことについて",
            kyoko.look("何度か円山公園のゴミ拾いに参加しているけれど",
                "この日はいつもに比べて空き缶やお菓子のゴミ",
                "ビニール袋などの戦利品が少なかった"),
            matsu.ask("結構歩いたけど",
                "どうする？"),
            kyoko.look("木陰に入ったところで$matsumotoが$meたちを見下ろして尋ねた。",
                "その表情に「もう十分だろ？」という気分を感じ取ったけれど",
                "時間にしてまだ三十分も経っていない"),
            saito.ask("暑くなってきましたね"),
            kyoko.think("なら離れてくれればいいのに",
                "と思う$saitoはずっと$meの傍で",
                "今は左の肩を$meの右肩に付けている"),
            kyoko.think("$sayamaも一緒ならたぶん$matsumotoの意見に賛成していただろうけれど",
                "$kunugiは意外ときっちりしているから",
                "ゴミ袋をもう少し太らせないといけないだろうな",
                "という考えが巡る"),
            matsu.talk("ちょっとだけ", "これ頼むわ"),
            kyoko.ask("え？"),
            kyoko.deal("そう言って$matsumotoはゴミ袋を渡すと",
                "一人で勝手に駆けて行ってしまう"),
            saito.talk("トイレかな？"),
            kyoko.look("冗談ではないのだろうけれど",
                "真顔でそう尋ねた$saitoがおかしくて",
                "何だか吹き出してしまった"),
            saito.ask("え？", "何かまた変なこと言ってる？"),
            kyoko.talk("ううん。",
                "大丈夫ですよ。",
                "それよりちょっと休憩いれましょう"),
            kyoko.deal("$meは足元が濡れていないことを確認して腰を下ろす。",
                "$saitoもそれに倣って座ったが",
                "彼女はわざわざハンカチを取り出してそれを自分の下に敷いた"),
            saito.ask("やっぱり変？"),
            kyoko.talk("ううん。",
                "全然そんなことないです。",
                "寧ろ自分の方が気にしてないんだなと思って"),
            kyoko.look("フォローのつもりではなくそう言ったのだが",
                "$saitoは気にしたようで",
                "三角座りで膝を抱え込むと",
                "そこに顎を沈めた"),
            saito.talk("いつもなの"),
            kyoko.hear("彼女は足元を見つめたまま言った"),
            saito.talk("他人のことを気にして行動してるつもりなんだけど",
                "どこかズレてるみたいで",
                "クスクスって笑われて",
                "なんか悪いことしているんだって気分になって",
                "適当な愛想笑いして",
                "そっと逃げ出すんです"),
            kyoko.look("$saitoは$meの方を見ずにそのまま話す。",
                "相槌も待たないし",
                "それどころかどう思うのかを耳に入れたくないみたいに",
                "小さな声で言葉を並べた"),
            saito.talk("最初はね", "ちゃんとどこが悪くてどこがおかしくて笑うのか",
                    "いちいち聞き返してたんですよ？",
                    "でもそのうちに相手が答えてくれなくなって",
                    "最終的に『ごめん』って謝られちゃうんです。",
                    "けどそれってたぶん$meの方が悪くて",
                    "そんな風にしているうちに段々$meってみんなから避けられているのかなって思うようになって"),
            kyoko.think("彼女の話のはずなのに",
                    "まるで自分の学生時代を告白されている気分になる。",
                    "$meもまた周囲とうまく距離感が掴めず",
                    "集団からいつも少し離れてぽつんと一人でいる方だった"),
            saito.talk("だからいつの間にか誰とも喋らなくなったし",
                    "誘われても行かなくなったし",
                    "誰かと一緒にいたいと思うこともなくなった。",
                    "一人いる方が何も気にしなくていいから楽なんだなって分かってからは",
                    "$meにとって友だちは本や漫画だった。",
                    "そういうのを暗いって言われるんだったらもう$meは暗い子ちゃんでいいし",
                    "でも誰かと関わり合いにならないなら",
                    "そんな風に何か言われることすらないんだなって"),
            kyoko.talk("$saito"),
            saito.ask("あ……ごめんなさい。",
                    "$meったらまた"),
            kyoko.deal("$meはそっと手を伸ばして",
                    "彼女の膝を押さえている手に重ねる"),
            kyoko.talk("大丈夫ですよ。",
                    "何もおかしなことなんて言ってませんから。",
                    "それより",
                    "好きな本とか漫画とか", "食べ物とか。",
                    "友だちと話したかったことを", "$meと話しませんか？"),
            kyoko.look("彼女はやっと$meに顔を向けたけれど",
                    "その目には大粒の涙が光っていて",
                    "見ているうちにぽろりとその一粒が落ちていった"),
            saito.talk("$me", "$kyokoと友だちになれて", "良かったです"),
            matsu.talk("おーい"),
            kyoko.deal("$meが$saitoにハンカチを出して渡そうとしたところで",
                    "$matsumotoが戻ってくる。",
                    "その手には三本のペットボトルが抱えられていた"),
            matsu.talk("オレンジとリンゴとお茶", "好きなのどうぞ"),
            kyoko.talk("買ってきてくれたんですか？"),
            kyoko.look("そうだが", "と不思議そうな顔をする彼から$meはオレンジを",
                    "$saitoはリンゴを貰って",
                    "そのひんやりとしたボトルを両手で抱いた"),
            matsu.talk("その……$meっていつも間が悪いっつーか",
                    "どうもＫＹってやつなんすよ"),
            kyoko.ask("$matsumotoさんがＫＹ？"),
            matsu.talk("知らないすか？",
                    "空気読めとか何とかっての"),
            kyoko.behav("$meは$saitoと顔を見合わせて笑う。",
                    "口元こそ押さえたけれど",
                    "笑い声までは隠せなかった"),
            matsu.talk("何か変すか？",
                    "けど$saitoと深刻っぽい話してたんじゃないんすか？"),
            kyoko.look("堀の深い顔が困惑で歪む。",
                    "でもその歪んだ眉がおかしくて",
                    "やっぱりまた笑ってしまう"),
            kyoko.talk("$saitoも$meも$matsumotoさんのことそんな風に思ってませんよ。",
                    "それに深刻なことを話してた訳じゃなくて",
                    "ちょっとした昔の思い出話で泣いちゃってただけだから。",
                    "ですよね？"),
            saito.talk("うん。", "そう。", "ありがとう"),
            kyoko.look("$matsumotoは相変わらず分からないといった表情のままだが",
                    "それでもお茶のボトルキャップを外して豪快に喉を鳴らすと",
                    "$meの足元に置いたゴミ袋を持ってくれた"),
            kyoko.ask("そういえば$matsumotoさんて彼女持ちなんですよね？"),
            kyoko.deal("背を向けて芝生の上を駆けている子供たちを見やる彼に",
                    "$meは思い切って尋ねてみる"),
            matsu.talk("ええ", "いますよ。", "同棲中です"),
            saito.talk("そ、そうなんだ……"),
            kyoko.look("やはりこの手の話題が好きなのか",
                    "$saitoは頬の色を少し変えて$matsumotoを見上げた"),
            kyoko.talk("その彼女とはさ", "結婚とか考えたりしているんですか？"),
            saito.talk("ちょっと$kyoko", "そんな大胆な"),
            matsu.reply("結婚はちょっとできないすね"),
            kyoko.look("考える素振りもなく即答すると",
                    "彼は再びお茶を飲む"),
            kyoko.ask("そうですよね。",
                    "まだ若いし"),
            matsu.talk("いや", "そういうんじゃなくて……まあ色々事情があるんで"),
            kyoko.look("明らかに$saitoの表情が変わった。",
                    "$meを見て", "もっと訊いてとばかりに腕を小突く"),
            kyoko.think("けれどわざわざ言葉を濁したところをみると",
                    "無理やり聞き出すのは躊躇われた"),
            kyoko.deal("$meはキャップを捻り",
                    "オレンジ果汁十パーセントの砂糖水を流し込む。",
                    "$saitoもそれに倣ったのか", "既に開けていたリンゴジュースを飲んだが",
                    "$meの顔を覗き込んでから何度か目線を彼の筋肉質で大きな背中へと向ける"),
            kyoko.talk("$matsumotoさんて高校までは何か部活してたんですか？"),
            matsu.talk("高校はやってないです。",
                    "中学まではバスケでしたけど"),
            kyoko.look("彼はそれに答えるのもこちらには一切表情を見せないままで",
                    "それがわざとなのかどうなのか",
                    "$meには判断が付かなかった。",
                    "それでも他人に踏み込んで欲しくない一線を彼も持っているんだと感じて",
                    "$meの抱いていた$n_matsumotoという人物への印象は大きく変わった"),
            )

def sc_birthanother(w: wd.World):
    kyoko, shota, child, stu, univ = w.kyoko, w.shota, w.child_kyoko, w.student_kyoko, w.univ_kyoko
    return w.scene("三人目の誕生",
            kyoko.be(w.stage.living).d("その日は$kunugiが用事があるというので",
                "いつもみたいにファミレスで集まってから解散という流れにはならず",
                "現地解散した後",
                "$sayamaと$saitoの三人でカフェで一時間ほど過ごした"),
            kyoko.think("実は高校時代に$sayamaも$saitoも男子から告白された経験があると知って驚かされたが",
                "よく考えると$meもつい最近", "よく分からない男性から同じようなことを言われたのだと思い出す"),
            kyoko.deal("アパートのドアを開けて昼下がりの陽が差し込むリビングに戻ると",
                "$childも$studentも横並びで眠っていた。",
                "いつもなら騒がしいところなのに", "逆にこんな風だと何かあったんじゃないかと戸惑ったくらいだ"),
            kyoko.look("冷蔵庫の中を確認して妙なものが増えていないかどうかを見る"),
            kyoko.think("あの$n_shotaが現れて以来",
                "時々奇妙なことが起こっているから神経質になっていた"),
            kyoko.talk("大丈夫"),
            kyoko.behav("わざわざ口に出して安堵すると",
                "部屋に戻り", "出されている課題に手をつけようと思ってノートに手を伸ばす"),
            kyoko.look("課題の殆どはレポートで",
                "図書館で借りてきた資料が山積みになっていたが",
                "読むだけでもなかなか骨が折れた"),
            kyoko.think("そういえば$saitoが一緒にレポート課題とかやりたいと言っていたことを思い出し",
                "携帯電話を手に取る"),
            kyoko.look("着信記録があった"),
            kyoko.look("それも友だちや大学の知人からではない"),
            kyoko.look("$n_father。", "$meの今の父親だ"),
            univ.talk("かけないの", "電話？"),
            kyoko.think("え？"),
            kyoko.look("後ろから声がして",
                "でもそれが$childのものでも$studentのものでもなかったから",
                "$meは振り返ることができずにそのまま声を返す"),
            kyoko.talk("だれ？"),
            univ.talk("誰じゃないでしょう？",
                "こっちを見れば分かる。",
                "それとも……また逃げ出す？"),
            kyoko.feel("背中を嫌な汗が流れ落ちていった"),
            kyoko.feel("心臓は強く早く脈打ち",
                "$meは呼吸がうまくできない"),
            univ.talk("ま、$meのことはいいから", "電話してみたら？"),
            kyoko.look("それでも一度だけ",
                "顔を少しだけ回して思い切り目線だけを後ろに飛ばす"),
            kyoko.look("そこには赤い眼鏡を掛けたもう一人の$meが",
                "右手を腰にやってじっと立っていた"),
            kyoko.talk("嘘……"),
            kyoko.look("彼女は笑う"),
            kyoko.talk("そんな……そんなはず"),
            kyoko.feel("呼吸が苦しい"),
            kyoko.feel("視界がちらついて",
                "$meは体を開いて後ろを見ると",
                "支えようとした右手から体勢を崩して半分寝たような格好になる"),
            kyoko.look("彼女はそんな$meを見下ろしながら近づいてきて",
                "すっと手を伸ばした"),
            univ.talk("大丈夫？", "$n_kyokoさん？"),
            kyoko.ask("あなたは……"),
            univ.talk("$meはね",
                    "$n_univ_kyoko。", "大学二年生よ"),
            # TODO: 動揺、翌朝、三人目が誕生している、生まれた瞬間のこと
            )

def sc_mydad(w: wd.World):
    return w.scene("私の父親",
            # TODO: 父親を待つ駅前、再会
            )

# episodes
def ep_intro(w: wd.World):
    return (w.chaptertitle("プロポーズ"),
            sc_proposed(w),
            )

def ep_meeting(w: wd.World):
    return (w.chaptertitle("翔太郎のこと"),
            sc_favor(w),
            sc_withshota(w),
            sc_hispresent(w),
            )

def ep_4thanother(w: wd.World):
    kyoko = w.kyoko
    return (w.chaptertitle("四番目の今日子"),
            sc_strangeteam(w),
            sc_talksteady(w),
            sc_birthanother(w),
            sc_mydad(w),
                kyoko.come(w.stage.living),
                kyoko.deal(w.i.meeting),
                kyoko.come(w.stage.living),
                kyoko.look(w.another),
                kyoko.be(w.i.birth_another),
            )

# outline
def base_info(w: wd.World):
    return ("chapter3", story(w), w.kyoko, w.shota)

def story_outline(w: wd.World):
    return [
            ("chapter3", story(w),
            w.kyoko.think(w.i.proposed),
            w.kyoko.deal(w.i.proposed, w.shota),
            w.kyoko.deal(w.i.meeting),
            w.kyoko.be(w.i.birth_another),
            True),
            ]

# main
def story(w: wd.World):
    return [w.chaptertitle(cnf.TITLE["chap3"]),
            ep_intro(w),
            ep_meeting(w),
            ep_4thanother(w),
            ]


def main(): # pragma: no cover
    from src.anotherme.story import world
    w = world()
    return w.build(story(w))


if __name__ == '__main__':
    import sys
    sys.exit(main())

